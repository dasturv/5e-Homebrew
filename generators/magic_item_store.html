<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Magic Item Shop - DND 5th Edition</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
	<link rel="stylesheet" href="../styles.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>
<body>
	<header class="header-wrap">
		<div class="header-color"></div>
		<div class="row justify-content-center">
			<div class="col-md-9 col-sm-12 header-text">
				<h1>Laec's DND 5e Homebrew</h1>
				<h3><a href="../index.html">Home</a></h3>
			</div>
		</div>
	</header>
	<div class="row justify-content-center">
		<div class="col-md-9 col-sm-12 main-content">
			<div class="page-title">
				Generator: Magic Item Shop
			</div>
			<div id="itemDisplay">Press the Button for an Item!</div>
			<button id="generateButton">Generate Item</button>
		</div>
	</div>
</body>
<footer>
	<script type="text/javascript">
		//Common Minor Items
		const common_minor_items = [
			"Potion of Healing",
			"Potion of Mana",
			"Bead of Nourishment",
			"Bead of Refreshment",
			"Feather Token",
			"Medal of Muscle",
			"Medal of the Conch",
			"Medal of the Horizonback",
			"Medal of the Maze",
			"Medal of the Meat Pie",
			"Medal of the Wetlands",
			"Medal of Wit",
			"Potion of Climbing",
			"Potion of Watchful Rest",
			"Spell Scroll (Cantrip)",
			"Spell Scroll (1st)",
			"Unbreakable Ammunition x5",
			"Walloping Ammunition x5"
		];

		const common_minor_weights = [
			50,
			25,
			10,
			10,
			7,
			7,
			5,
			5,
			7,
			7,
			10,
			5,
			7,
			7,
			10,
			15,
			15,
			10
		];

		const itemDisplay = document.getElementById('itemDisplay');
		const generateButton = document.getElementById('generateButton');

		function roll(number, dice, mod) {
			var total = mod;
			for (let i = 0; i < number; i++) {
				total = total + Math.floor(Math.random() * dice) + 1;
			}
			return Math.max(0,total);
		}

		function getWeightedRandomItem(items, weights) {
			const cumulativeWeights = [];
			for (let i = 0; i < weights.length; i++) {
				cumulativeWeights[i] = weights[i] + (cumulativeWeights[i - 1] || 0);
			}

			const totalWeight = cumulativeWeights[cumulativeWeights.length - 1];
			const randomNumber = Math.floor(Math.random() * totalWeight);
			console.log(totalWeight);

			for (let i = 0; i < cumulativeWeights.length; i++) {
				if (cumulativeWeights[i] > randomNumber) {
					return items[i];
				}
			}
		}

		generateButton.addEventListener('click', () => {
			const randomItem = getWeightedRandomItem(common_minor_items, common_minor_weights);
			itemDisplay.textContent = randomItem;
		});

	</script>
</footer>
</html>